<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }} | {{ .Site.Title }}{{ end }}</title>

{{/* CSS Loading (Modern Hugo Syntax) */}}
{{ $options := (dict "targetPath" "css/style.css" "outputStyle" "compressed") }}
{{/* FIX: resources.ToCSS -> css.Sass */}}
{{ $style := resources.Get "scss/main.scss" | css.Sass $options }}
<link rel="stylesheet" href="{{ $style.Permalink }}">

{{/* THEME ENGINE: Blocking Script for Immediate Paint */}}
<script>
  (function() {
    try {
      const validThemes = ['sound', 'market', 'mountain', 'forest', 'sunset'];
      const savedTheme = localStorage.getItem('greg_theme');
      // Only apply if the value is strictly in our allowlist
      if (validThemes.includes(savedTheme)) {
        document.documentElement.setAttribute('data-theme', savedTheme);
      }
    } catch (e) {
      // Fail silently (Privacy settings might block LocalStorage)
    }
  })();
</script>

<meta name="generator" content="Hugo {{ hugo.Version }}" />
{{/* IndieWeb Metadata */}}
<link rel="webmention" href="https://webmention.io/{{ .Site.Params.webmentions.username }}/webmention" />
<link rel="pingback" href="https://webmention.io/{{ .Site.Params.webmentions.username }}/xmlrpc" />
<link rel="authorization_endpoint" href="https://indieauth.com/auth">
<link rel="token_endpoint" href="https://tokens.indieauth.com/token">
<link rel="me" href="https://github.com/somegregariousdude" />
