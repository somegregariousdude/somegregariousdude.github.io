{{/* Universal Syndication Component */}}
{{/* Usage: partial "syndication.html" . */}}

{{ if .Params.syndication }}
<div class="syndication-container">
  <span class="syndication-label">Also on:</span>
  <div class="syndication-chips">
    {{ range .Params.syndication }}
      {{ $synURL := . }}
      {{ $match := false }}
      {{ $data := dict }}
      
      {{/* LOOKUP: Match URL to Social Config for Icons */}}
      {{ range $.Site.Params.social }}
         {{ if in $synURL .url }}
           {{ $match = true }}
           {{ $data = . }}
         {{ end }}
      {{ end }}

      <a href="{{ $synURL }}" class="chip u-syndication" rel="syndication">
        {{ if $match }}
           {{/* Icon Block: Silent for screen readers */}}
           {{ if $data.icon }}
             <span class="chip-icon" aria-hidden="true" style="color: var(--md-sys-color-primary);">
               {{ partial (printf "icons/%s.svg" $data.icon) . }}
             </span>
           {{ end }}
           <span class="chip-label">{{ $data.name }}</span>
        {{ else }}
           {{/* Fallback for unknown sites: Extract Domain */}}
           <span class="chip-label">{{ replaceRE "^https?://([^/]+).*" "$1" $synURL }}</span>
        {{ end }}
      </a>
    {{ end }}
  </div>
</div>
{{ end }}
